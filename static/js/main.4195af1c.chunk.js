(this["webpackJsonpoutlook-categorized"]=this["webpackJsonpoutlook-categorized"]||[]).push([[0],{38:function(e,t,a){e.exports=a(53)},43:function(e,t,a){},53:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(18),l=a.n(o),s=(a(43),a(3)),i=a(4),c=a(16),u=a(20),h=a(19),d=a(56),m=a(31),p=a(33),f=a(32),g=a(35),v=a(57),y=a(1),k=a.n(y),b=a(14),E=(a(26),a(22)),w=function(){function e(t){Object(s.a)(this,e),this.authtoken=void 0,this.authtoken=t}return Object(i.a)(e,[{key:"getAccessToken",value:function(){var e=this;return new Promise((function(t,a){e.authtoken?t(e.authtoken):a("No Auth Token Provided")}))}}]),e}(),x=function(){function e(t){Object(s.a)(this,e),this.client=void 0,this.categories=void 0,this.folders=void 0,this.existingCategoryFolders=void 0,this.createdCategoryFolders=void 0;var a=new w(t);this.client=E.a.initWithMiddleware({authProvider:a}),this.categories=new Set,this.folders=new Set,this.existingCategoryFolders=new Set,this.createdCategoryFolders=new Set,this.getUser(),this.createMailSearchFolders()}return Object(i.a)(e,[{key:"getUser",value:function(){var e=Object(b.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.client.api("/me").get();case 3:t=e.sent,console.log(t),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"getCategories",value:function(){var e=Object(b.a)(k.a.mark((function e(){var t,a,r=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.categories=new Set,e.prev=1,e.next=4,this.client.api("/me/outlook/masterCategories?$top=500").get();case 4:t=e.sent,a=function(e){return r.categories.add(e.displayName),!0},new E.b(this.client,t,a).iterate(),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"getFolders",value:function(){var e=Object(b.a)(k.a.mark((function e(){var t,a,r,n=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.folders=new Set,e.prev=1,e.next=4,this.client.api("/me/mailFolders?$top=500").get();case 4:t=e.sent,a=function(e){return n.folders.add(e.displayName.toLowerCase()),!0},(r=new E.b(this.client,t,a)).iterate(),r.isComplete()||r.resume(),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(1),e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getRootFolderId",value:function(){var e=Object(b.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.client.api("/me/mailFolders/inbox").get();case 3:return t=e.sent,e.abrupt("return",t.parentFolderId);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"createMailSearchFolders",value:function(){var e=Object(b.a)(k.a.mark((function e(){var t,a,r,o,s,i,c;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCategories();case 2:return e.next=4,this.getFolders();case 4:return e.next=6,this.getRootFolderId();case 6:t=e.sent,a=Array.from(this.categories.values()),r=Array.from(this.folders.values()),this.existingCategoryFolders=new Set,this.createdCategoryFolders=new Set,o=0,s=a;case 12:if(!(o<s.length)){e.next=33;break}if(i=s[o],!(r.indexOf(i.toLowerCase())>-1)){e.next=19;break}console.log(i+" folder already exists! Skipping this category."),this.existingCategoryFolders.add(i),e.next=30;break;case 19:return c={"@odata.type":"microsoft.graph.mailSearchFolder",displayName:i,includeNestedFolders:!0,sourceFolderIds:[t],filterQuery:"categories/any(t: t eq '".concat(i,"')")},console.log(c),e.prev=21,e.next=24,this.client.api("/me/mailFolders/".concat(t,"/childFolders")).post(c);case 24:this.createdCategoryFolders.add(i),e.next=30;break;case 27:throw e.prev=27,e.t0=e.catch(21),e.t0;case 30:o++,e.next=12;break;case 33:l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement("p",null,n.a.createElement("strong",null,"Existing virtual category folders or conflicting folder names:")),n.a.createElement("p",null,Array.from(this.existingCategoryFolders.values()).join(", ")),n.a.createElement("p",null,n.a.createElement("strong",null,"Newly created virtual mail folders:")),n.a.createElement("p",null,Array.from(this.createdCategoryFolders.values()).join(", "))),document.getElementById("results"));case 34:case"end":return e.stop()}}),e,this,[[21,27]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),C=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e)).state={token:""},r.handleChange=r.handleChange.bind(Object(c.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(c.a)(r)),r}return Object(i.a)(a,[{key:"handleSubmit",value:function(e){new x(this.state.token),e.preventDefault()}},{key:"handleChange",value:function(e){this.setState({token:e.target.value})}},{key:"render",value:function(){return r.createElement(d.a,{onSubmit:this.handleSubmit},r.createElement(m.a,null,r.createElement(p.a,null,"Graph API Explorer Access Token:"),r.createElement(f.a,{placeholder:"Graph API Access token",as:"textarea",rows:6,type:"text",size:"sm",name:"accesstoken",id:"tokenfield",onChange:this.handleChange}),r.createElement(g.a,null,"This API token is not stored. It is only used locally in your browser to use the Microsoft Graph API directly.")),r.createElement(v.a,{variant:"primary",type:"submit"},"Create virtual category folders"))}}]),a}(r.Component);var F=function(){return r.createElement(C,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var S=a(54),O=a(55),j=a(34);l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(S.a,{fluid:"sm"},n.a.createElement(O.a,{className:"justify-content-md-center"},n.a.createElement(j.a,null),n.a.createElement(j.a,{xs:10},n.a.createElement("h1",null,"Outlook virtually categorized"),n.a.createElement("h5",null,"This app creates cross-device, cross-client virtual folders for each of your Outlook categories."),n.a.createElement("hr",null),n.a.createElement("p",null,"For more information and the source code of this app, please visit ",n.a.createElement("a",{href:"https://github.com/berndverst/outlook-categorized"},"berndverst/outlook-categorized"),"."),n.a.createElement("p",null,n.a.createElement("strong",null,"Instructions"),n.a.createElement("ol",null,n.a.createElement("li",null,"Visit ",n.a.createElement("a",{href:"https://developer.microsoft.com/graph/graph-explorer?wt.mc_id=outlookcategorized-github-beverst"},"Microsoft Graph Explorer"),"\xa0 to obtain an API access token for your account.",n.a.createElement("ol",null,n.a.createElement("li",null,"Sign into your Office365 or Outlook account."),n.a.createElement("li",null,"Click on the Access Token tab."),n.a.createElement("li",null,"Click on the Copy icon or manually copy the token text."))),n.a.createElement("li",null,"Paste the access token below and press the button to automatically create new virtual folders that will sync across your devices and email clients."))),n.a.createElement(F,null)),n.a.createElement(j.a,null)),"\xa0",n.a.createElement(O.a,null),n.a.createElement(O.a,null,n.a.createElement(j.a,null),n.a.createElement(j.a,{xs:10},n.a.createElement("div",{id:"results"})),n.a.createElement(j.a,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.4195af1c.chunk.js.map